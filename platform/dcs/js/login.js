function doLogin(e,o,i){dialog.load("正在登录，请等待..."),postUrl="/cashlogin",void 0!==window.IS_MOBILE&&(postUrl="/mobile/cashlogin"),$.ajax({url:postUrl,type:"POST",dataType:"JSON",data:{account:e,password:o,affKey:$("#aff-key-login").val(),code:i},success:function(e){$("#login-captcha").click(),dialog.close(),e.success?window.IS_MOBILE?checklogin(e.message):location.href="/member/agreement?"+e.message:e.message?dialog.error("消息",e.message):dialog.error("消息","抱歉，登录失败!")},error:function(e,o,i){alert(e.responseText)}})}function checklogin(e){e=e?"/member/checklogin?"+e:"/member/checklogin?client="+Math.random(),void 0!==window.IS_MOBILE&&(e="/mobile"+e),$.ajax({url:e,type:"POST",dataType:"JSON",success:function(e){e.success?(void 0!==window.IS_MOBILE&&(window.location="/mobile/member/lobby"),$(".header-links").css("display","block"),$(".login").css("display","none"),$(".username").text(e.data.userName),1==e.data.tesing?($(".header-center").css("display","none"),$(".header-payment").css("display","none")):($(".header-center").css("display","block"),$(".header-payment").css("display","block"))):($(".login").css("display","block"),$(".header-links").css("display","none"),$(".username").text(""),$(".header-center").css("display","block"),$(".header-payment").css("display","block"))}})}var msg="游客盘口只供试玩，与正式会员盘口无关!";$(function(){checklogin(""),$("#login-captcha").click(function(){$(this).attr("src","code?_="+(new Date).getTime())}),$("#guestLogin").click(function(){alert(msg),doLogin("!guest!","!guest!")}),$(".login input").keypress(function(e){if(13==e.keyCode)return $("#btnlogin").click(),!1}),$("#btn-register").click(function(){location.href="/register"}),$("#btnlogin").click(function(){var e=$("#username").val(),o=$("#password").val(),i=$("#vcode").val();return""==e?void dialog.error("消息","用户名和密码都不能为空"):""==o?void dialog.error("消息","用户名和密码都不能为空"):""==i?void dialog.error("消息","验证码不能为空"):void doLogin(e,o,i)})});